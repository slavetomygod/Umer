<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Set Quantity - FS Traders</title>
  <link rel="stylesheet" href="css.css">
  <style>
    .items-list {
      width: 90%;
      margin: 20px auto;
      position: relative;
      z-index: 2;
    }
    .item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px;
      margin: 15px 0;
      background: rgba(0,200,170,0.05);
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,128,128,0.2);
    }
    .item span {
      flex: 1;
      text-align: center;
      font-size: 16px;
      font-weight: bold;
    }
    .controls {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .controls button {
      background: teal;
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      font-size: 18px;
      cursor: pointer;
      transition: 0.2s;
    }
    .controls button:hover {
      background: #0d9488;
    }
    .controls input {
      width: 50px;
      text-align: center;
      font-size: 16px;
      border: 2px solid teal;
      border-radius: 6px;
      padding: 3px;
    }
    .remove-btn {
      background: red !important;
      width: 28px;
      height: 28px;
      font-size: 14px;
    }
    .set-price {
      background: orange;
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;

      .img-preview{
  position: fixed; /* follow cursor on the page */
  pointer-events: none;
  z-index: 9999;
  background: #fff;
  border-radius: 12px;
  padding: 6px;
  box-shadow: 0 6px 20px rgba(0,0,0,.2);
  display: none;
}
.img-preview img{
  max-width: 200px;
  max-height: 200px;
  border-radius: 8px;
  display: block;
}

    }
  </style>
</head>
<body>

  <!-- ===== Menu Toggle ===== -->
  <button id="menuToggle">‚ò∞</button>

  <!-- ===== Sidebar ===== -->
  <nav id="sidebar">
    <ul>
      <li><a href="homepage.html">üè† Home</a></li>
      <li><a href="itemsinfo.html">üìã Items Info</a></li>
    
      <li><a href="newitem.html">‚ûï New Item</a></li>
    </ul>
  </nav>
  <div id="overlay"></div>

  <!-- ===== Shop Value Box ===== -->
  <div id="shop-value">Shop Value: ‚Çπ0</div>

  <!-- ===== FS Traders Title ===== -->
  <div class="title">
    <div class="fs">FS</div>
    <div class="traders">Traders</div>
  </div>

  <!-- ===== Items List ===== -->
  <div class="items-list" id="quantityList">
    <!-- JS will render items with quantity controls -->
  </div>

  <!-- ===== Waves ===== -->
  <div class="wave-container">
    <div class="wave"></div>
    <div class="wave"></div>
    <div class="wave"></div>
  </div>

  <!-- ===== Scripts ===== -->
  <script src="localstorage.js"></script>
  <script>

  // ===== MENU TOGGLE =====
  const menuToggle = document.getElementById("menuToggle");
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("overlay");

  menuToggle.addEventListener("click", () => {
    sidebar.style.width = "250px";
    overlay.style.display = "block";
  });
  overlay.addEventListener("click", () => {
    sidebar.style.width = "0";
    overlay.style.display = "none";
  });

  // ===== Render Items with Expandable Controls =====
  function renderQuantityPage() {
    let list = document.getElementById("quantityList");
    if (!list) return;

    let items = JSON.parse(localStorage.getItem("items")) || [];
    list.innerHTML = "";

    if (items.length === 0) {
      list.innerHTML = `<p style="text-align:center; color:red; font-weight:bold;">No items found!</p>`;
      return;
    }

    items.forEach((item, index) => {
      let div = document.createElement("div");
      div.className = "item";
      
      div.innerHTML = `
        <span>${item.name}</span>
        <span>‚Çπ${item.price}</span>
        <span>Qty: ${item.quantity || 0}</span>
        <div class="controls" id="controls-${index}" style="display:none; margin-top:10px;">
          <button onclick="updateQuantity(${index}, -1)">-</button>
          <input type="number" value="${item.quantity || 0}" 
                 onchange="setQuantity(${index}, this.value)">
          <button onclick="updateQuantity(${index}, 1)">+</button>
          <button class="remove-btn" onclick="removeItem(${index})">x</button>
        </div>
      `;

      // Toggle controls when clicking the item
      div.addEventListener("click", () => {
        const controls = document.getElementById(`controls-${index}`);
        controls.style.display = (controls.style.display === "none") ? "flex" : "none";
      });

      list.appendChild(div);
    });
  }

  // ===== Quantity Functions =====
  function updateQuantity(index, change) {
    let items = JSON.parse(localStorage.getItem("items")) || [];
    if (!items[index]) return;

    items[index].quantity = Math.max(0, (items[index].quantity || 0) + change);
    localStorage.setItem("items", JSON.stringify(items));

    renderQuantityPage();
    renderShopValue();
  }

  function setQuantity(index, value) {
    let items = JSON.parse(localStorage.getItem("items")) || [];
    if (!items[index]) return;

    let qty = parseInt(value);
    items[index].quantity = isNaN(qty) ? 0 : Math.max(0, qty);

    localStorage.setItem("items", JSON.stringify(items));

    renderQuantityPage();
    renderShopValue();
  }

  function removeItem(index) {
    let items = JSON.parse(localStorage.getItem("items")) || [];
    if (!items[index]) return;

    if (confirm(`Remove "${items[index].name}"?`)) {
      items.splice(index, 1);
      localStorage.setItem("items", JSON.stringify(items));

      renderQuantityPage();
      renderShopValue();
    }
  }

  // ===== INIT =====
  renderQuantityPage();

  if (hasImg) {
  attachHoverPreview(wrap, item.image);
}

</script>

</body>
</html>
